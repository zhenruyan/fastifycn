<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Routes</title>
  <meta name="description" content="Fast and low overhead web framework, for Node.js">

  <link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.5.1/css/bulma.min.css" integrity="sha256-CDVQJfU+jJGU/oyDzvnzuGXbv0rz+SyBsPQwyn7x/jQ=" crossorigin="anonymous" />
  <link rel="stylesheet" href="/css/style.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous" />

  
    <link ref="canonical" href="/docs/v0.33.x/Routes">
  

  
</head>


  <body>
    <nav id="main-navbar" class="navbar">
  <div class="navbar-brand">
    <a class="navbar-item" href="/">
      <img src="/images/fastify-logo-menu.png" alt="Fastify: Fast and low overhead web framework, for Node.js" height="28">
    </a>

    <a class="navbar-item is-hidden-desktop" href="https://github.com/fastify/fastify" target="_blank">
      <span class="icon" style="color: #333;">
        <i class="fa fa-github"></i>
      </span>
    </a>

    <div class="navbar-burger burger" data-target="mobileMenu">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <div class="navbar-menu" id="mobileMenu">
    <div class="navbar-start">
      <a class="navbar-item " href="/">Home</a>
      <a class="navbar-item " href="/docs/latest">Docs</a>
      <a class="navbar-item " href="/ecosystem">Ecosystem</a>
      <a class="navbar-item " href="/benchmarks">Benchmarks</a>
    </div>

    <div class="navbar-end">
      <a class="navbar-item" href="https://github.com/fastify/fastify" target="_blank">
        <span class="fa fa-github"> </span>&nbsp;Github
      </a>
    </div>
  </div>
</nav>


    <main class="page-content" aria-label="Content">
      
<section class="hero is-primary" style="background-image: url('/images/bg-pattern-bright.png')">
  <div class="hero-body">
      <div class="container">
        <h1 class="title">
          Documentation
        </h1>
      </div>
  </div>
</section>

<div class="container">
  <section class="section">
    <div class="columns">

      <div class="column is-3 is-hidden-mobile" data-sticky-container>
        <aside class="menu sticky">
          <p class="menu-label">
            Table of contents
          </p>
          <ul class="menu-list">
            
              <li >
                <a  href="/docs/latest/Getting-Started">Getting Started</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Server-Methods">Server Methods</a>
              </li>
            
              <li id="doc-menu-section">
                <a class="is-active" href="/docs/latest/Routes">Routes</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Logging">Logging</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Middlewares">Middlewares</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Hooks">Hooks</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Decorators">Decorators</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Validation-and-Serialization">Validation and Serialization</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Lifecycle">Lifecycle</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Reply">Reply</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Request">Request</a>
              </li>
            
              <li >
                <a  href="/docs/latest/ContentTypeParser">Content Type Parser</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Plugins">Plugins</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Testing">Testing</a>
              </li>
            
              <li >
                <a  href="/docs/latest/Plugins-Guide">Plugins Guide</a>
              </li>
            
              <li >
                <a  href="/docs/latest/HTTP2">HTTP2</a>
              </li>
            
          </ul>
          <div class="content" style="margin: .8em; border-top: 1px solid #ccc; padding: .8em 0 0 0">
            Docs version
            <div class="field">
              <div class="control">
                <div class="select">
                  <select onchange="if (this.value) window.location.href=this.value">
                    
                      
                        
                        
                          <option  value="/docs/master">master</option>
                      
                    
                      
                        
                        
                          
                        
                          <option selected="selected" value="/docs/v0.33.x">v0.33.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.32.x">v0.32.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.31.x">v0.31.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.30.x">v0.30.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.29.x">v0.29.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.28.x">v0.28.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.27.x">v0.27.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.26.x">v0.26.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.25.x">v0.25.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.24.x">v0.24.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.23.x">v0.23.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.22.x">v0.22.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.21.x">v0.21.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.20.x">v0.20.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.19.x">v0.19.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.18.x">v0.18.x</option>
                      
                    
                      
                    
                  </select>
                </div>
              </div>
            </div>
          </div>
        </aside>
      </div>

      <div class="column">
        <nav class="breadcrumb">
          <ul>
            <li><a href="/" style="padding-left: 0">Fastify</a></li>
            <li><a href="/docs/">Documentation</a></li>
            <li>
              <div class="field">
                <div class="control">
                  <div class="select">
                    <select onchange="if (this.value) window.location.href=this.value" style="border: none;">
                      
                        
                          
                          <option  value="/docs/master">master</option>
                        
                      
                        
                          
                          <option selected="selected" value="/docs/v0.33.x">v0.33.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.32.x">v0.32.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.31.x">v0.31.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.30.x">v0.30.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.29.x">v0.29.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.28.x">v0.28.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.27.x">v0.27.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.26.x">v0.26.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.25.x">v0.25.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.24.x">v0.24.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.23.x">v0.23.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.22.x">v0.22.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.21.x">v0.21.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.20.x">v0.20.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.19.x">v0.19.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.18.x">v0.18.x</option>
                        
                      
                        
                      
                    </select>
                  </div>
                </div>
              </div>
            </li>
            <li class="is-active"><a>Routes</a></li>
          </ul>
        </nav>

        <div id="doc-content" class="content">
          <h2 id="routes">Routes</h2>
<p><a name="full-declaration"></a></p>
<h3 id="full-declaration">Full declaration</h3>
<pre><code class="lang-js">fastify.route(options)
</code></pre>
<ul>
<li><p><code>method</code>: currently it supports <code>&#39;DELETE&#39;</code>, <code>&#39;GET&#39;</code>, <code>&#39;HEAD&#39;</code>, <code>&#39;PATCH&#39;</code>, <code>&#39;POST&#39;</code>, <code>&#39;PUT&#39;</code> and <code>&#39;OPTIONS&#39;</code>. It could also be an array of methods.</p>
</li>
<li><p><code>url</code>: the path of the url to match this route (alias: <code>path</code>).</p>
</li>
<li><p><code>schema</code>: an object containing the schemas for the request and response.
They need to be in
<a href="http://json-schema.org/">JSON Schema</a> format, check <a href="/docs/latest/Validation-and-Serialization">here</a> for more info.</p>
<ul>
<li><code>body</code>: validates the body of the request if it is a POST or a
PUT.</li>
<li><code>querystring</code>: validates the querystring. This can be a complete JSON
Schema object, with the property <code>type</code> of <code>object</code> and <code>properties</code> object of parameters, or
simply the values of what would be contained in the <code>properties</code> object as shown below.</li>
<li><code>params</code>: validates the params.</li>
<li><code>response</code>: filter and generate a schema for the response, setting a
schema allows us to have 10-20% more throughput.</li>
</ul>
</li>
<li><code>beforeHandler(request, reply, done)</code>: a <a href="/docs/latest/Hooks#before-handler">function</a> called just before the request handler, useful if you need to perform authentication at route level for example, it could also be and array of functions.</li>
<li><code>handler(request, reply)</code>: the function that will handle this request.</li>
<li><p><code>schemaCompiler(schema)</code>: the function that build the schema for the validations. See <a href="/docs/latest/Validation-and-Serialization#schema-compiler">here</a></p>
<p><code>request</code> is defined in <a href="/docs/latest/Request">Request</a>.</p>
<p><code>reply</code> is defined in <a href="/docs/latest/Reply">Reply</a>.</p>
</li>
</ul>
<p>The routing is handled by <a href="https://github.com/delvedor/find-my-way">find-my-way</a>, so you can refer its documentation for the url building.</p>
<p>Example:</p>
<pre><code class="lang-js">fastify.route({
  method: &#39;GET&#39;,
  url: &#39;/&#39;,
  schema: {
    querystring: {
      name: { type: &#39;string&#39; },
      excitement: { type: &#39;integer&#39; }
    },
    response: {
      200: {
        type: &#39;object&#39;,
        properties: {
          hello: { type: &#39;string&#39; }
        }
      }
    }
  },
  handler: function (request, reply) {
    reply.send({ hello: &#39;world&#39; })
  }
})
</code></pre>
<pre><code class="lang-js">fastify.route({
  method: &#39;GET&#39;,
  url: &#39;/&#39;,
  schema: { ... },
  beforeHandler: function (request, reply, done) {
    // your authentication logic
    done()
  },
  handler: function (request, reply) {
    reply.send({ hello: &#39;world&#39; })
  }
})
</code></pre>
<p><a name="shorthand-declaration"></a></p>
<h3 id="shorthand-declaration">Shorthand declaration</h3>
<p>The above route declaration is more <em>Hapi</em>-like, but if you prefer an <em>Express/Restify</em> approach, we support it as well:
<code>fastify.get(path, [options], handler)</code>
<code>fastify.head(path, [options], handler)</code>
<code>fastify.post(path, [options], handler)</code>
<code>fastify.put(path, [options], handler)</code>
<code>fastify.delete(path, [options], handler)</code>
<code>fastify.options(path, [options], handler)</code>
<code>fastify.patch(path, [options], handler)</code></p>
<p>Example:</p>
<pre><code class="lang-js">const opts = {
  schema: {
    response: {
      200: {
        type: &#39;object&#39;,
        properties: {
          hello: { type: &#39;string&#39; }
        }
      }
    }
  }
}
fastify.get(&#39;/&#39;, opts, (req, reply) =&gt; {
  reply.send({ hello: &#39;world&#39; })
})
</code></pre>
<p><code>fastify.all(path, [options], handler)</code> will add the same handler to all the supported methods.</p>
<p><a name="async-await"></a></p>
<h3 id="async-await">Async Await</h3>
<p>Are you an <code>async/await</code> user? We have you covered!</p>
<pre><code class="lang-js">fastify.get(&#39;/&#39;, options, async function (request, reply) {
  var data = await getData()
  var processed = await processData(data)
  return processed
})
</code></pre>
<p>As you can see we are not calling <code>reply.send</code> to send back the data to the user. You just need to return the body and you are done!
If you need it you can also send back the data to the user with <code>reply.send</code>.</p>
<pre><code class="lang-js">fastify.get(&#39;/&#39;, options, async function (request, reply) {
  var data = await getData()
  var processed = await processData(data)
  reply.send(processed)
})
</code></pre>
<p><strong>Warning:</strong> If you use <code>return</code> and <code>reply.send</code> at the same time, the first one that happens takes precedence, the second value will be discarded, a <em>warn</em> log will also be emitted if the value is not <code>undefined</code>.</p>
<p><a name="route-prefixing"></a></p>
<h3 id="route-prefixing">Route Prefixing</h3>
<p>Sometimes you need to maintain two or more different versions of the same api, a classic approach is to prefix all the routes with the api version number, <code>/v1/user</code> for example.
Fastify offers you a fast and smart way to create different version of the same api without changing all the route names by hand, <em>route prefixing</em>. Let&#39;s see how it works:</p>
<pre><code class="lang-js">// server.js
const fastify = require(&#39;fastify&#39;)()

fastify.register(require(&#39;./routes/v1/users&#39;), { prefix: &#39;/v1&#39; })
fastify.register(require(&#39;./routes/v2/users&#39;), { prefix: &#39;/v2&#39; })

fastify.listen(3000)
</code></pre>
<pre><code class="lang-js">// routes/v1/users.js
module.exports = function (fastify, opts, next) {
  fastify.get(&#39;/user&#39;, handler_v1)
  next()
}
</code></pre>
<pre><code class="lang-js">// routes/v2/users.js
module.exports = function (fastify, opts, next) {
  fastify.get(&#39;/user&#39;, handler_v2)
  next()
}
</code></pre>
<p>Fastify will not complain because you are using the same name for two different routes, because at compilation time it will handle the prefix automatically <em>(this also means that the performance will not be affected at all!)</em>.</p>
<p>Now your clients will have access to the following routes:</p>
<ul>
<li><code>/v1/user</code></li>
<li><code>/v2/user</code></li>
</ul>
<p>You can do this as many times as you want, it works also for nested <code>register</code> and routes parameter are supported as well.
Be aware that if you use <a href="https://github.com/fastify/fastify-plugin"><code>fastify-plugin</code></a> this option won&#39;t work.</p>

        </div>

        <hr/>
        <nav class="level">
        
          
        
          
        
          
            <div class="level-left">
              <div class="level-item">
                
                  
                  
                  <a href="/docs/latest/Server-Methods" class="button prev">≪ Server Methods</a>
                
              </div>
            </div>
            <div class="level-right">
              <div class="level-item">
                
                  
                  
                  <a href="/docs/latest/Logging" class="button next">Logging ≫</a>
                
              </div>
            </div>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        </nav>
      </div>
    </div>
  </section>

  <script>
    // dynamically creates a submenu for the current section based on the content headers
    var titles = document.querySelectorAll('#doc-content h3')
    var currentMenu = document.getElementById('doc-menu-section')
    if (titles.length && currentMenu) {
      var submenu = document.createElement('ul')
      titles.forEach(el => {
        var currentSubmenuItem = document.createElement('li')
        var currentSubmenuLink = document.createElement('a')
        currentSubmenuLink.href = '#' + el.id
        currentSubmenuLink.append(document.createTextNode(el.textContent))
        currentSubmenuItem.append(currentSubmenuLink)
        submenu.append(currentSubmenuItem)
      })
      currentMenu.append(submenu)
    }
  </script>
</div>

    </main>

    <footer class="grey is-primary footer">
  <div class="container">
    <div class="content has-text-centered">
    
      <p>Fastify, Copyright &copy; 2016-2017 Matteo Collina and the <a href="https://github.com/fastify/fastify#team" target="_blank">Fastify team</a>, Licensed under <a href="https://github.com/fastify/fastify/blob/master/LICENSE" target="_blank">MIT</a></p>
    </div>
  </div>
</footer>


    <script src="/js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>

</html>
